#include "gribtypes.h"

/*
 * g1int to int
 */
int
g1i(x)
    int x;
{
    return x;
}


/*
 * g2int to int
 */
int
g2i(x)
    g2int x;
{
    return x[1] + 256*x[0];
}


/*
 * g2sint to int
 */
int
g2si(x)
    g2sint x;
{
    int ret = x[1] + 256*(x[0] & 0x7f);

    return (x[0] & 0x80) ? -ret : ret;
}


/*
 * g3int to int
 */
int
g3i(x)
    g3int x;
{
    return x[2] + 256*(x[1] + 256*(x[0]));
}


/*
 * g3sint to int
 */
int
g3si(x)
    g3sint x;
{
    int ret = x[2] + 256*(x[1] + 256*(x[0] & 0x7f));
    
    return (x[0] & 0x80) ? -ret : ret;
}


/*
 * g4flt to float
 */
float
g4f(x)
    g4flt x;
{
    float ret;
    static double c[] = {	/* 2**-24 * 16**-i, for i=-64, -63, ..., 63 */
	5.14755758946803e-85, 8.23609214314885e-84, 1.31777474290382e-82,
	2.1084395886461e-81, 3.37350334183377e-80, 5.39760534693403e-79,
	8.63616855509444e-78, 1.38178696881511e-76, 2.21085915010418e-75,
	3.53737464016668e-74, 5.6597994242667e-73, 9.05567907882671e-72,
	1.44890865261227e-70, 2.31825384417964e-69, 3.70920615068742e-68,
	5.93472984109987e-67, 9.4955677457598e-66, 1.51929083932157e-64,
	2.43086534291451e-63, 3.88938454866321e-62, 6.22301527786114e-61,
	9.95682444457783e-60, 1.59309191113245e-58, 2.54894705781192e-57,
	4.07831529249908e-56, 6.52530446799852e-55, 1.04404871487976e-53,
	1.67047794380762e-52, 2.6727647100922e-51, 4.27642353614751e-50,
	6.84227765783602e-49, 1.09476442525376e-47, 1.75162308040602e-46,
	2.80259692864963e-45, 4.48415508583941e-44, 7.17464813734306e-43,
	1.14794370197489e-41, 1.83670992315982e-40, 2.93873587705572e-39,
	4.70197740328915e-38, 7.52316384526264e-37, 1.20370621524202e-35,
	1.92592994438724e-34, 3.08148791101958e-33, 4.93038065763132e-32,
	7.88860905221012e-31, 1.26217744835362e-29, 2.01948391736579e-28,
	3.23117426778526e-27, 5.16987882845642e-26, 8.27180612553028e-25,
	1.32348898008484e-23, 2.11758236813575e-22, 3.3881317890172e-21,
	5.42101086242752e-20, 8.67361737988404e-19, 1.38777878078145e-17,
	2.22044604925031e-16, 3.5527136788005e-15, 5.6843418860808e-14,
	9.09494701772928e-13, 1.45519152283669e-11, 2.3283064365387e-10,
	3.72529029846191e-09, 5.96046447753906e-08, 9.5367431640625e-07,
	1.52587890625e-05, 0.000244140625, 0.00390625, 0.0625, 1., 16., 256.,
	4096., 65536., 1048576., 16777216., 268435456., 4294967296., 68719476736.,
	1099511627776., 17592186044416., 281474976710656., 4.5035996273705e+15,
	7.20575940379279e+16, 1.15292150460685e+18, 1.84467440737096e+19,
	2.95147905179353e+20, 4.72236648286965e+21, 7.55578637259143e+22,
	1.20892581961463e+24, 1.93428131138341e+25, 3.09485009821345e+26,
	4.95176015714152e+27, 7.92281625142643e+28, 1.26765060022823e+30,
	2.02824096036517e+31, 3.24518553658427e+32, 5.19229685853483e+33,
	8.30767497365572e+34, 1.32922799578492e+36, 2.12676479325587e+37,
	3.40282366920938e+38, 5.44451787073502e+39, 8.71122859317602e+40,
	1.39379657490816e+42, 2.23007451985306e+43, 3.5681192317649e+44,
	5.70899077082384e+45, 9.13438523331814e+46, 1.4615016373309e+48,
	2.33840261972944e+49, 3.74144419156711e+50, 5.98631070650738e+51,
	9.57809713041181e+52, 1.53249554086589e+54, 2.45199286538542e+55,
	3.92318858461668e+56, 6.27710173538668e+57, 1.00433627766187e+59,
	1.60693804425899e+60, 2.57110087081438e+61, 4.11376139330302e+62,
	6.58201822928482e+63, 1.05312291668557e+65, 1.68499666669691e+66,
	2.69599466671506e+67, 4.3135914667441e+68 };

    ret = c[x[0] & 0x7f] * ((int)x[3] + 256*(int)(x[2] + 256*(int)(x[1])));

    if (x[0] & 0x80)
	return -ret;
    else
	return ret;
}


